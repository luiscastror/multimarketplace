<app-nav></app-nav>
<div class="container mt-3">
    <div class="row mb-3">
        <div class="col-12">
            <app-components-title-subtitle title="Carrito"
                subtitle="Este es tu carrito, encuentras los productos divididos por negocio" justify="start">
            </app-components-title-subtitle>
        </div>
    </div>
    <div class="row mb-5" *ngFor="let business of MainService.CartService.listCart; index as indexBusiness">
        <div class="col-12" *ngIf="business.items.length > 0">
            <div class="card">
                <div class="card-header bg-color-primary">
                    <p class="text-white fw-normal">
                        Tienda: {{business.business.name | uppercase}} - {{business.items.length}} Productos
                    </p>
                </div>
                <div class="card-body">
                    <div class="row mb-3 py-3" *ngFor="let product of business.items; index as indexProduct"
                        [ngClass]="{'border-top':  business.items.length > 1 && indexProduct > 0}">
                        <div class="mb-3 mb-md-0 col-md-4 d-flex flex-row justify-content-center align-items-center">
                            <img src="https://http2.mlstatic.com/D_NQ_NP_821669-MCO72777449727_112023-O.webp"
                                class="img-fluid img-thumbnail" style="max-height: 150px;">
                        </div>
                        <div class="mb-3 mb-md-0 col-md-4">
                            <p class="fw-bold f18 color-primary">
                                Humidificador Difusor De Aromas Ambientador Con Llama Led
                            </p>
                            <p class="fw-light f14 mb-3">Presentamos el difusor de aromas y esencias con diseño moderno
                                el
                                cual
                                tiene la función difundir aromas por 8 horas o
                                más con apagado automático, el cual tiene la opción de seleccionar cambio de colores lo
                                que lo hace muy novedoso único
                                en su clase.</p>
                            <button mat-flat-button color="warn" (click)="removeItem(indexBusiness,indexProduct)">
                                Eliminar producto
                            </button>
                        </div>
                        <div class="mb-3 mb-md-0 col-md-4 d-flex flex-column align-items-md-end">
                            <div class="w-100 d-flex flex-row justify-content-between align-items-center">
                                <p>Valor: </p>
                                <p>${{product.value | number}}</p>
                            </div>
                            <div class="w-100 d-flex flex-row justify-content-between align-items-center">
                                <p>Cantidad: </p>
                                <div class="d-flex flex-row gap-1">
                                    <button *ngIf="product.count == 1" (click)="removeItem(indexBusiness,indexProduct)"
                                        class="btn btn-cart-count bg-danger text-white d-flex flex-row justify-content-center align-items-center">
                                        <span class="material-symbols-outlined">
                                            delete
                                        </span>
                                    </button>
                                    <button *ngIf="product.count > 1"
                                        (click)="product.count = product.count - 1; changeCart();"
                                        class="btn btn-cart-count bg-danger text-white d-flex flex-row justify-content-center align-items-center">
                                        <span class="material-symbols-outlined">
                                            remove
                                        </span>
                                    </button>
                                    <input type="tel" class="form-control btn-cart-count" style="width: 50px;"
                                        (change)="changeCart()" [value]="product.count" readonly>
                                    <button
                                        class="btn btn-cart-count bg-color-secondary text-white d-flex flex-row justify-content-center align-items-center"
                                        (click)="product.count = product.count + 1; changeCart();">
                                        <span class="material-symbols-outlined">
                                            add
                                        </span>
                                    </button>
                                </div>
                            </div>
                            <div class="w-100 d-flex flex-row justify-content-between align-items-center">
                                <p>Descuento: </p>
                                <p class="text-danger fw-bold">$10.000</p>
                            </div>
                            <div class="w-100 d-flex flex-row justify-content-between align-items-center">
                                <p>Total: </p>
                                <p>
                                    <span class="text-decoration-line-through f14 text-secondary me-1">
                                        ${{(product.value * product.count) | number}}</span>
                                    <span class="color-secondary fw-bold f20">
                                        ${{(product.value * product.count) - 10000 | number}}
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div
                    class="card-footer d-flex flex-column flex-md-row justify-content-between gap-3 align-items-center">
                    <div>
                        <p>**Esta checkout se procesa por separado a el resto y pertenece al negocio
                            ({{business.business.name | uppercase}})</p>
                    </div>
                    <div>
                        <button mat-flat-button color="accent">
                            <mat-icon>shopping_cart_checkout</mat-icon>
                            <span>Procesar pedido -> Pagar</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- <app-components-product-cart></app-components-product-cart> -->
    </div>
</div>

<app-components-footer></app-components-footer>
<!-- 
<app-nav></app-nav>
<div class="container bg-light">
    <div class="row">
        <h2 class="border-bottom border-success border-3 w-25  px-5 mx-5 my-3">Descripcion</h2>
    </div>
</div>

<main>
    <div class="container">
        <div class="row" *ngFor="let item of listProducts">
            <app-components-product-cart></app-components-product-cart>
        </div>
    </div>
</main>

<app-components-footer></app-components-footer> -->